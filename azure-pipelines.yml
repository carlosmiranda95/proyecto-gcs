trigger:
- master

pool:
  vmImage: ubuntu-latest

steps:
- script: sudo apt-get update -y
  displayName: 'Actualizar Repositorio'

- script: sudo apt-get install default-jre -y
  displayName: 'Instalar Java'

#- script: sbt test
#  displayName: 'Correr Pruebas Unitarias'

- script: sbt rpm:packageBin
  displayName: 'Empaquetar Aplicacion'

- script: sudo apt-get install scp -y
  displayName: 'Instalar Herramienta SCP'

- script: cd /home/vsts/work/1/s/gcs-app/target/rpm/RPMS/noarch/
  displayName: 'Ubicarse en ruta de Compilado'

- task: FilePostgres
  name: DbKey
  displayName: "Descargar Llave Privada de Servidor DB"
  inputs:
    secureFile: "srv-postgres_key.pem.pem"

- script: echo $(DbKey.secureFilePath)
#- script: 
#    echo Installing $(caCertificate.secureFilePath) to the trusted CA directory...
#    sudo chown root:root $(caCertificate.secureFilePath)
#    sudo chmod a+r $(caCertificate.secureFilePath)
#    sudo ln -s -t /etc/ssl/certs/ $(caCertificate.secureFilePath)